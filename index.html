<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ó–∞–ø–∏—Å–∞—Ç—å —Å–ª–æ–≤–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: #f5f5f5;
            padding: 15px;
            padding-bottom: 30px;
            max-width: 600px;
            margin: 0 auto;
            -webkit-text-size-adjust: 100%;
            -webkit-font-smoothing: antialiased;
        }

        .header {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .header h1 {
            font-size: 24px;
            color: #333;
            margin: 0;
        }

        .swap-btn {
            background: #2196F3;
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            transition: background 0.2s;
            -webkit-tap-highlight-color: transparent;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .swap-btn:active {
            background: #0b7dda;
        }

        .swap-btn:focus {
            outline: none;
        }

        .stats {
            font-size: 14px;
            color: #666;
        }

        /* –°–µ–∫—Ü–∏—è –≤–≤–æ–¥–∞ */
        .input-section {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .columns-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 15px;
        }

        .column-section {
            width: 100%;
        }

        .column-section.russian {
            order: 1;
        }

        .column-section.arabic {
            order: 2;
        }

        /* –†–µ–∂–∏–º —Ä–µ–≤–µ—Ä—Å–∞ */
        .columns-container.reversed .column-section.russian {
            order: 2;
        }

        .columns-container.reversed .column-section.arabic {
            order: 1;
        }

        .column-label {
            font-size: 14px;
            font-weight: 600;
            color: #666;
            margin-bottom: 8px;
            display: block;
        }

        .column-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .input-row {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .input-row input {
            flex: 1;
            padding: 16px 14px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 17px;
            line-height: 1.4;
            min-height: 52px;
            transition: border-color 0.2s;
            -webkit-appearance: none;
        }

        .input-row input:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .input-row.arabic input {
            direction: rtl;
            text-align: right;
            font-family: 'Traditional Arabic', 'Arabic Typesetting', Arial;
            font-size: 20px;
        }

        .add-column-btn {
            background: #4CAF50;
            color: white;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 8px;
            font-size: 20px;
            cursor: pointer;
            flex-shrink: 0;
            transition: background 0.2s;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
            touch-action: manipulation;
        }

        .add-column-btn:active {
            background: #45a049;
        }

        .add-column-btn:focus {
            outline: none;
        }

        .remove-column-btn {
            background: #f44336;
            color: white;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            flex-shrink: 0;
            transition: background 0.2s;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
            touch-action: manipulation;
        }

        .remove-column-btn:active {
            background: #da190b;
        }

        .remove-column-btn:focus {
            outline: none;
        }

        .separator {
            display: none;
        }

        .add-word-btn {
            width: 100%;
            padding: 16px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            -webkit-tap-highlight-color: transparent;
        }

        .add-word-btn:active:not(:disabled) {
            background: #45a049;
        }

        .add-word-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        /* –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤ */
        .words-section {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .words-section h2 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #333;
        }

        .words-list {
            height: 400px;
            overflow-y: auto;
            margin-bottom: 15px;
            -webkit-overflow-scrolling: touch;
        }

        .word-item {
            padding: 12px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
            transition: background 0.2s;
        }

        .word-item:hover {
            background: #f9f9f9;
        }

        .word-text {
            flex: 1;
            font-size: 16px;
            color: #333;
            word-break: break-word;
            cursor: pointer;
        }

        .word-actions {
            display: flex;
            gap: 5px;
        }

        .edit-btn, .delete-btn {
            background: transparent;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 18px;
            transition: background 0.2s;
            -webkit-tap-highlight-color: transparent;
        }

        .edit-btn {
            color: #2196F3;
        }

        .edit-btn:active {
            background: #e3f2fd;
        }

        .delete-btn {
            color: #f44336;
        }

        .delete-btn:active {
            background: #ffebee;
        }

        .actions-buttons {
            display: flex;
            gap: 10px;
        }

        .copy-all-btn, .clear-all-btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            -webkit-tap-highlight-color: transparent;
        }

        .copy-all-btn {
            background: #2196F3;
            color: white;
        }

        .copy-all-btn:active {
            background: #0b7dda;
        }

        .clear-all-btn {
            background: #f44336;
            color: white;
        }

        .clear-all-btn:active {
            background: #da190b;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #999;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 25px;
            border-radius: 16px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .modal-content h3 {
            margin-bottom: 15px;
            font-size: 20px;
            color: #333;
        }

        .modal-content input {
            width: 100%;
            padding: 16px 14px;
            margin-top: 8px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 17px;
            line-height: 1.4;
            min-height: 52px;
            box-sizing: border-box;
            -webkit-appearance: none;
        }

        .modal-input-row {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-top: 8px;
        }

        .modal-input-row input {
            flex: 1;
            margin-top: 0;
        }

        .modal-add-btn {
            background: #4CAF50;
            color: white;
            border: none;
            width: 44px;
            height: 52px;
            border-radius: 8px;
            font-size: 20px;
            cursor: pointer;
            flex-shrink: 0;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
            touch-action: manipulation;
        }

        .modal-add-btn:active {
            background: #45a049;
        }

        .modal-add-btn:focus {
            outline: none;
        }

        .modal-section {
            margin-bottom: 20px;
        }

        .modal-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .modal-section-header strong {
            color: #666;
        }

        .modal-content input:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-buttons button {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
        }

        .save-btn {
            background: #4CAF50;
            color: white;
        }

        .save-btn:active {
            background: #45a049;
        }

        .cancel-btn {
            background: #ccc;
            color: #333;
        }

        .cancel-btn:active {
            background: #b8b8b8;
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #4CAF50;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 2000;
            display: none;
            animation: slideDown 0.3s ease;
        }

        .notification.show {
            display: block;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-top">
            <h1>üìù –ó–∞–ø–∏—Å–∞—Ç—å —Å–ª–æ–≤–∞</h1>
            <button class="swap-btn" id="swapBtn" title="–ü–æ–º–µ–Ω—è—Ç—å –ø–æ—Ä—è–¥–æ–∫ –∫–æ–ª–æ–Ω–æ–∫">
                üîÑ
            </button>
        </div>
        <div class="stats">
            –í—Å–µ–≥–æ —Å–ª–æ–≤: <span id="totalCount">0</span>
        </div>
    </div>

    <div class="input-section">
        <div class="columns-container" id="columnsContainer">
            <div class="column-section russian">
                <span class="column-label">üá∑üá∫ –†—É—Å—Å–∫–∏–π:</span>
                <div class="column-group" id="russianColumns">
                    <div class="input-row">
                        <input 
                            type="text" 
                            placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ" 
                            data-lang="ru"
                            inputmode="text"
                            autocapitalize="sentences"
                            autocorrect="on"
                            spellcheck="true">
                        <button class="add-column-btn" data-lang="ru">+</button>
                    </div>
                </div>
            </div>

            <div class="separator">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>

            <div class="column-section arabic">
                <span class="column-label">üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©:</span>
                <div class="column-group" id="arabicColumns">
                    <div class="input-row arabic">
                        <input 
                            type="text" 
                            placeholder="ÿßŸÉÿ™ÿ® ÿßŸÑŸÉŸÑŸÖÿ©" 
                            data-lang="ar"
                            inputmode="text"
                            autocapitalize="off"
                            autocorrect="off"
                            spellcheck="false">
                        <button class="add-column-btn" data-lang="ar">+</button>
                    </div>
                </div>
            </div>
        </div>

        <button class="add-word-btn" id="addWordBtn" onclick="addWord()">
            ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ
        </button>
    </div>

    <div class="words-section">
        <h2>üìö –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤</h2>
        <div class="words-list" id="wordsList"></div>
        <div class="actions-buttons">
            <button class="copy-all-btn" onclick="copyAllWords()">
                üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
            </button>
            <button class="clear-all-btn" onclick="clearAllWords()">
                üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Å–ø–∏—Å–æ–∫
            </button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
    <div class="modal" id="editModal">
        <div class="modal-content">
            <h3>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–≤–æ</h3>
            <div id="editColumnsContainer"></div>
            <div class="modal-buttons">
                <button class="save-btn" onclick="saveEdit()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="cancel-btn" onclick="closeEditModal()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        let currentEditIndex = null;

        // –î–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É
        function addColumn(lang) {
            const container = document.getElementById(lang === 'ru' ? 'russianColumns' : 'arabicColumns');
            const newRow = document.createElement('div');
            newRow.className = 'input-row' + (lang === 'ar' ? ' arabic' : '');
            
            const input = document.createElement('input');
            input.type = 'text';
            input.placeholder = lang === 'ru' ? '–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ' : 'ÿßŸÉÿ™ÿ® ÿßŸÑŸÉŸÑŸÖÿ©';
            input.dataset.lang = lang;
            input.setAttribute('inputmode', 'text');
            
            if (lang === 'ar') {
                input.setAttribute('autocapitalize', 'off');
                input.setAttribute('autocorrect', 'off');
                input.setAttribute('spellcheck', 'false');
            } else {
                input.setAttribute('autocapitalize', 'sentences');
                input.setAttribute('autocorrect', 'on');
                input.setAttribute('spellcheck', 'true');
            }
            
            const removeBtn = document.createElement('button');
            removeBtn.className = 'remove-column-btn';
            removeBtn.textContent = '‚úï';
            
            newRow.appendChild(input);
            newRow.appendChild(removeBtn);
            container.appendChild(newRow);
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è
            setupButtonHandler(removeBtn, () => removeColumn(removeBtn));
            
            // –§–æ–∫—É—Å –Ω–∞ –Ω–æ–≤–æ–º –ø–æ–ª–µ
            requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                    input.focus();
                    // –ö—É—Ä—Å–æ—Ä –≤ –∫–æ–Ω–µ—Ü –Ω–∞ iOS
                    if (input.setSelectionRange) {
                        input.setSelectionRange(input.value.length, input.value.length);
                    }
                });
            });
            
            checkForm();
        }

        // –£–¥–∞–ª–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É
        function removeColumn(btn) {
            const row = btn.parentElement;
            const container = row.parentElement;
            
            // –ù–µ –¥–∞–µ–º —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –∫–æ–ª–æ–Ω–∫—É
            if (container.children.length > 1) {
                // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–µ –ø–æ–ª–µ –¥–ª—è —Ñ–æ–∫—É—Å–∞
                const prevRow = row.previousElementSibling;
                row.remove();
                
                // –§–æ–∫—É—Å–∏—Ä—É–µ–º—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –ø–æ–ª–µ
                if (prevRow) {
                    const prevInput = prevRow.querySelector('input');
                    requestAnimationFrame(() => {
                        requestAnimationFrame(() => {
                            prevInput.focus();
                            // –ö—É—Ä—Å–æ—Ä –≤ –∫–æ–Ω–µ—Ü
                            if (prevInput.setSelectionRange) {
                                prevInput.setSelectionRange(prevInput.value.length, prevInput.value.length);
                            }
                        });
                    });
                }
                
                checkForm();
            }
        }

        // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –∫–æ–ª–æ–Ω–æ–∫
        function getColumnValues(lang) {
            const container = document.getElementById(lang === 'ru' ? 'russianColumns' : 'arabicColumns');
            const inputs = container.querySelectorAll('input');
            return Array.from(inputs)
                .map(input => input.value.trim())
                .filter(value => value !== '');
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º—ã
        function checkForm() {
            const ruValues = getColumnValues('ru');
            const arValues = getColumnValues('ar');
            const btn = document.getElementById('addWordBtn');
            
            // –ú–∏–Ω–∏–º—É–º –æ–¥–Ω–æ —Ä—É—Å—Å–∫–æ–µ –∏ –æ–¥–Ω–æ –∞—Ä–∞–±—Å–∫–æ–µ —Å–ª–æ–≤–æ
            btn.disabled = ruValues.length === 0 || arValues.length === 0;
        }

        // –°–ª—É—à–∞—Ç–µ–ª–∏ –Ω–∞ –≤—Å–µ –∏–Ω–ø—É—Ç—ã
        document.addEventListener('input', (e) => {
            if (e.target.tagName === 'INPUT') {
                checkForm();
            }
        });

        // –î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ
        function addWord() {
            const ruValues = getColumnValues('ru');
            const arValues = getColumnValues('ar');

            if (ruValues.length === 0 || arValues.length === 0) return;

            // –§–æ—Ä–º–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫—É: "—Ä—É—Å—Å–∫–∏–π, —Ä—É—Å—Å–∫–∏–π - –∞—Ä–∞–±—Å–∫–∏–π - –∞—Ä–∞–±—Å–∫–∏–π"
            const ruPart = ruValues.join(', ');
            const arPart = arValues.join(' - ');
            const wordText = `${ruPart} - ${arPart}`;

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º
            const words = JSON.parse(localStorage.getItem('words') || '[]');
            words.push(wordText);
            localStorage.setItem('words', JSON.stringify(words));

            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            clearForm();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
            renderWords();
            
            // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showNotification('‚úì –°–ª–æ–≤–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ');
        }

        // –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É
        function clearForm() {
            // –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ –∏–Ω–ø—É—Ç—ã
            const ruContainer = document.getElementById('russianColumns');
            const arContainer = document.getElementById('arabicColumns');
            
            while (ruContainer.children.length > 1) {
                ruContainer.removeChild(ruContainer.lastChild);
            }
            while (arContainer.children.length > 1) {
                arContainer.removeChild(arContainer.lastChild);
            }
            
            // –û—á–∏—â–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
            document.querySelectorAll('input').forEach(input => input.value = '');
            checkForm();
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤
        function renderWords() {
            const wordsList = document.getElementById('wordsList');
            const words = JSON.parse(localStorage.getItem('words') || '[]');
            
            document.getElementById('totalCount').textContent = words.length;

            if (words.length === 0) {
                wordsList.innerHTML = '<div class="empty-state">–ü–æ–∫–∞ –Ω–µ—Ç —Å–ª–æ–≤</div>';
                return;
            }

            wordsList.innerHTML = words.map((word, index) => `
                <div class="word-item">
                    <div class="word-text" onclick="editWord(${index})">${word}</div>
                    <div class="word-actions">
                        <button class="edit-btn" onclick="editWord(${index})">‚úèÔ∏è</button>
                        <button class="delete-btn" onclick="deleteWord(${index})">üóëÔ∏è</button>
                    </div>
                </div>
            `).join('');
        }

        // –£–¥–∞–ª–∏—Ç—å —Å–ª–æ–≤–æ
        function deleteWord(index) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ —Å–ª–æ–≤–æ?')) return;
            
            const words = JSON.parse(localStorage.getItem('words') || '[]');
            words.splice(index, 1);
            localStorage.setItem('words', JSON.stringify(words));
            renderWords();
            showNotification('üóëÔ∏è –°–ª–æ–≤–æ —É–¥–∞–ª–µ–Ω–æ');
        }

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–≤–æ
        function editWord(index) {
            currentEditIndex = index;
            const words = JSON.parse(localStorage.getItem('words') || '[]');
            const word = words[index];
            
            // –ü–∞—Ä—Å–∏–º —Å–ª–æ–≤–æ –æ–±—Ä–∞—Ç–Ω–æ
            const parts = word.split(' - ');
            const ruParts = parts[0].split(', ');
            const arParts = parts.slice(1);
            
            // –°–æ–∑–¥–∞–µ–º –ø–æ–ª—è –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            const container = document.getElementById('editColumnsContainer');
            container.innerHTML = '';
            
            // –†—É—Å—Å–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏
            const ruGroup = document.createElement('div');
            ruGroup.className = 'modal-section';
            ruGroup.id = 'editRuSection';
            
            const ruHeader = document.createElement('div');
            ruHeader.className = 'modal-section-header';
            ruHeader.innerHTML = '<strong>üá∑üá∫ –†—É—Å—Å–∫–∏–π:</strong>';
            ruGroup.appendChild(ruHeader);
            
            ruParts.forEach((val, i) => {
                const row = document.createElement('div');
                row.className = 'modal-input-row';
                const input = document.createElement('input');
                input.type = 'text';
                input.value = val;
                input.dataset.lang = 'ru';
                input.setAttribute('inputmode', 'text');
                input.setAttribute('autocapitalize', 'sentences');
                input.setAttribute('autocorrect', 'on');
                input.setAttribute('spellcheck', 'true');
                row.appendChild(input);
                ruGroup.appendChild(row);
            });
            
            // –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–∏—Ç—å —Ä—É—Å—Å–∫–æ–µ –ø–æ–ª–µ
            const ruAddBtn = document.createElement('button');
            ruAddBtn.className = 'modal-add-btn';
            ruAddBtn.textContent = '+';
            ruAddBtn.dataset.lang = 'ru';
            ruAddBtn.style.width = '100%';
            ruAddBtn.style.marginTop = '8px';
            ruGroup.appendChild(ruAddBtn);
            setupButtonHandler(ruAddBtn, () => addModalField('ru'));
            
            container.appendChild(ruGroup);
            
            // –ê—Ä–∞–±—Å–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏
            const arGroup = document.createElement('div');
            arGroup.className = 'modal-section';
            arGroup.id = 'editArSection';
            
            const arHeader = document.createElement('div');
            arHeader.className = 'modal-section-header';
            arHeader.innerHTML = '<strong>üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©:</strong>';
            arGroup.appendChild(arHeader);
            
            arParts.forEach((val, i) => {
                const row = document.createElement('div');
                row.className = 'modal-input-row';
                const input = document.createElement('input');
                input.type = 'text';
                input.value = val;
                input.style.direction = 'rtl';
                input.style.textAlign = 'right';
                input.style.fontFamily = "'Traditional Arabic', 'Arabic Typesetting', Arial";
                input.style.fontSize = '20px';
                input.dataset.lang = 'ar';
                input.setAttribute('inputmode', 'text');
                input.setAttribute('autocapitalize', 'off');
                input.setAttribute('autocorrect', 'off');
                input.setAttribute('spellcheck', 'false');
                row.appendChild(input);
                arGroup.appendChild(row);
            });
            
            // –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–∏—Ç—å –∞—Ä–∞–±—Å–∫–æ–µ –ø–æ–ª–µ
            const arAddBtn = document.createElement('button');
            arAddBtn.className = 'modal-add-btn';
            arAddBtn.textContent = '+';
            arAddBtn.dataset.lang = 'ar';
            arAddBtn.style.width = '100%';
            arAddBtn.style.marginTop = '8px';
            arGroup.appendChild(arAddBtn);
            setupButtonHandler(arAddBtn, () => addModalField('ar'));
            
            container.appendChild(arGroup);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            document.getElementById('editModal').classList.add('show');
        }

        // –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
        function addModalField(lang) {
            const section = document.getElementById(lang === 'ru' ? 'editRuSection' : 'editArSection');
            const addBtn = section.querySelector('.modal-add-btn');
            
            const row = document.createElement('div');
            row.className = 'modal-input-row';
            
            const input = document.createElement('input');
            input.type = 'text';
            input.placeholder = lang === 'ru' ? '–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ' : 'ÿßŸÉÿ™ÿ® ÿßŸÑŸÉŸÑŸÖÿ©';
            input.dataset.lang = lang;
            input.setAttribute('inputmode', 'text');
            
            if (lang === 'ar') {
                input.style.direction = 'rtl';
                input.style.textAlign = 'right';
                input.style.fontFamily = "'Traditional Arabic', 'Arabic Typesetting', Arial";
                input.style.fontSize = '20px';
                input.setAttribute('autocapitalize', 'off');
                input.setAttribute('autocorrect', 'off');
                input.setAttribute('spellcheck', 'false');
            } else {
                input.setAttribute('autocapitalize', 'sentences');
                input.setAttribute('autocorrect', 'on');
                input.setAttribute('spellcheck', 'true');
            }
            
            row.appendChild(input);
            section.insertBefore(row, addBtn);
            
            // –§–æ–∫—É—Å –Ω–∞ –Ω–æ–≤–æ–º –ø–æ–ª–µ
            requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                    input.focus();
                    // –ö—É—Ä—Å–æ—Ä –≤ –∫–æ–Ω–µ—Ü
                    if (input.setSelectionRange) {
                        input.setSelectionRange(input.value.length, input.value.length);
                    }
                });
            });
        }

        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
        function saveEdit() {
            const ruSection = document.getElementById('editRuSection');
            const arSection = document.getElementById('editArSection');
            
            const ruInputs = Array.from(ruSection.querySelectorAll('input[data-lang="ru"]'));
            const arInputs = Array.from(arSection.querySelectorAll('input[data-lang="ar"]'));
            
            const ruValues = ruInputs.map(i => i.value.trim()).filter(v => v !== '');
            const arValues = arInputs.map(i => i.value.trim()).filter(v => v !== '');
            
            if (ruValues.length === 0 || arValues.length === 0) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —Ä—É—Å—Å–∫–æ–µ –∏ –æ–¥–Ω–æ –∞—Ä–∞–±—Å–∫–æ–µ –ø–æ–ª–µ');
                return;
            }
            
            const ruPart = ruValues.join(', ');
            const arPart = arValues.join(' - ');
            const wordText = `${ruPart} - ${arPart}`;
            
            const words = JSON.parse(localStorage.getItem('words') || '[]');
            words[currentEditIndex] = wordText;
            localStorage.setItem('words', JSON.stringify(words));
            
            closeEditModal();
            renderWords();
            showNotification('‚úì –°–ª–æ–≤–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ');
        }

        // –ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        function closeEditModal() {
            document.getElementById('editModal').classList.remove('show');
            currentEditIndex = null;
        }

        // –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å–ª–æ–≤–∞
        function copyAllWords() {
            const words = JSON.parse(localStorage.getItem('words') || '[]');
            
            if (words.length === 0) {
                showNotification('‚ö†Ô∏è –ù–µ—Ç —Å–ª–æ–≤ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è');
                return;
            }
            
            const text = words.join('\n');
            
            // –ö–æ–ø–∏—Ä—É–µ–º –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(() => {
                    showNotification('üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
                });
            } else {
                // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showNotification('üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
            }
        }

        // –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Å–ª–æ–≤–∞
        function clearAllWords() {
            const words = JSON.parse(localStorage.getItem('words') || '[]');
            
            if (words.length === 0) {
                showNotification('‚ö†Ô∏è –°–ø–∏—Å–æ–∫ —É–∂–µ –ø—É—Å—Ç');
                return;
            }
            
            if (!confirm(`–£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–ª–æ–≤–∞ (${words.length} —à—Ç.)? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.`)) {
                return;
            }
            
            localStorage.removeItem('words');
            renderWords();
            showNotification('üóëÔ∏è –°–ø–∏—Å–æ–∫ –æ—á–∏—â–µ–Ω');
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 2000);
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –µ–≥–æ
        document.getElementById('editModal').addEventListener('click', (e) => {
            if (e.target.id === 'editModal') {
                closeEditModal();
            }
        });

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –¥–ª—è –∫–Ω–æ–ø–æ–∫ (touchstart –¥–ª—è iOS)
        function setupButtonHandler(button, callback) {
            // –î–ª—è iOS –∏—Å–ø–æ–ª—å–∑—É–µ–º touchstart —á—Ç–æ–±—ã –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–ª–∞—Å—å
            button.addEventListener('touchstart', function(e) {
                e.preventDefault();
                e.stopPropagation();
                callback();
            }, { passive: false });
            
            // –î–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ –æ—Å—Ç–∞–≤–ª—è–µ–º click
            button.addEventListener('click', function(e) {
                e.preventDefault();
                callback();
            });
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –Ω–∞—á–∞–ª—å–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫
        function initButtonHandlers() {
            // –ö–Ω–æ–ø–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫
            document.querySelectorAll('.add-column-btn').forEach(btn => {
                const lang = btn.dataset.lang;
                setupButtonHandler(btn, () => addColumn(lang));
            });
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –∫–æ–ª–æ–Ω–æ–∫
        function toggleColumnsOrder() {
            const container = document.getElementById('columnsContainer');
            const isReversed = container.classList.toggle('reversed');
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            localStorage.setItem('columnsReversed', isReversed ? 'true' : 'false');
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏
            const btn = document.getElementById('swapBtn');
            btn.style.transform = 'rotate(180deg)';
            setTimeout(() => {
                btn.style.transform = 'rotate(0deg)';
            }, 300);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Ä—è–¥–∫–∞ –∫–æ–ª–æ–Ω–æ–∫ –∏–∑ localStorage
        function loadColumnsOrder() {
            const isReversed = localStorage.getItem('columnsReversed') === 'true';
            if (isReversed) {
                document.getElementById('columnsContainer').classList.add('reversed');
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
        function initSwapButton() {
            const swapBtn = document.getElementById('swapBtn');
            setupButtonHandler(swapBtn, toggleColumnsOrder);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ø–ª–∞–≤–Ω—É—é –∞–Ω–∏–º–∞—Ü–∏—é
            swapBtn.style.transition = 'transform 0.3s ease';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        loadColumnsOrder();
        renderWords();
        checkForm();
        initButtonHandlers();
        initSwapButton();
    </script>
</body>
</html>
